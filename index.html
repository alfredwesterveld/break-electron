<html>
<head>
    <style>
        body {
            background: transparant;
        }

        .center {
            margin: auto;
            background-color: deepskyblue;
            width: 50%;
        }

        .center h1 {
            margin: 5px;
        }
    </style>
</head>
<body>
    <script>
        function hide() {
            win.hide();
        }

        function seconds(sec) {
            return parseInt(sec * 1000, 10);
        }

        Promise = require('bluebird');
        const fs = Promise.promisifyAll(require('fs'));
        const remote = require('remote')
        const win = remote.getCurrentWindow()

        const readPromise = fs.readFileAsync('./settings.json')

        const takeMicroBreakPromise = readPromise.then(function (data) {
            try {
                const obj = JSON.parse(data);
                const micro = obj.micro;

                const onInterval = function () {
                    win.showInactive();

                    Promise.delay(seconds(micro.time)).then(function (val) {
                        win.hide();
                    })
                }

                setInterval(onInterval, seconds(micro.after));
            } catch (e) {
                return e;
            }

        });

        readPromise.then(takeMicroBreakPromise);
    </script>
    <div class="center">
        <h1>Take a break</h1>

        <div>
            <button onclick="hide()">hide</button>
        </div>

    </div>
</body>
    </html>
